var forbes=(function(b,a){b.forms=(function(f){var l;function g(m){l=(typeof m.selector!="undefined")?f(m.selector):f("form.forbes_forms");if(l.length<1){return false}k();d();i();l.find("input[autofocus]").focus();c(m)}function c(m){if(typeof m=="undefined"){var m=new Object()}l.unbind("submit").bind("submit",function(){var q=f(this);if(!h(q)){if(typeof m.on_change!="undefined"){m.on_change()}return false}q.addClass("loadingstate");q.find(".fancy_button[data-submit-button=true]").addClass("loadingstate");var o=q.attr("action"),p="wp-admin/admin-ajax.php",n=o.indexOf(p);if(n!=-1&&o!=ppi_AjaxURI){forbes.util.debug("form_action: "+o);forbes.util.debug("ppi_AjaxURI: "+ppi_AjaxURI);o=ppi_AjaxURI+o.substring(n+p.length)}f.post(o,q.serialize(),function(u){q.removeClass("loadingstate");q.find(".fancy_radio").removeClass("loadingstate");if(typeof m.on_complete!="undefined"){if(!m.on_complete(u)){return false}}if(u.success){if(typeof u.url_success!="undefined"){window.location=u.url_success;return false}else{if(typeof u.refresh_window!="undefined"){window.location.reload();return false}}}else{var t=q.find(".main_error_msg");if(typeof u.errors!="undefined"){var r="<ul>";for(var s=0;s<u.errors.length;s++){r+="<li>";r+=u.errors[s].msg_html;r+="</li>"}r+="</ul>"}else{var r="<ul>";r+="<li>Unknown error</li>";r+="</ul>"}t.find(".text").html(r);t.show();q.removeClass("loadingstate");q.find(".fancy_button[data-submit-button=true]").removeClass("loadingstate");if(typeof m.on_change!="undefined"){m.on_change()}}},"json");return false})}function k(){l.find('.fancy_button[data-submit-button="true"]').each(function(){f(this).unbind("click").bind("click",function(){var m=f(this).parents("form");if(m.hasClass("loadingstate")){return false}m.trigger("submit");return false})})}function i(){l.find(".fancy_radio").each(function(){f(this).find("label:first").addClass("first_label");f(this).find("label:last").addClass("last_label");f(this).find('input[type="radio"]').unbind("change").bind("change",function(){e(f(this))})})}function e(m){forbes.util.debug("_update_fancy_radios()");var o=m,q=o.parent();var p=(o.is("label"))?o.attr("for"):o.attr("id");q.find("label").removeClass("checked");q.find('label[for="'+p+'"]').addClass("checked");if(q.attr("data-submit-form-on-change")=="true"){var n=o.parents("form");if(n.hasClass("loadingstate")){return false}n.submit()}}function d(){l.find("input.textbox").unbind("focus").bind("focus",function(){f(this).addClass("focused")});l.find("input.textbox").unbind("blur").bind("blur",function(){f(this).removeClass("focused")})}function h(m){var u=m.attr("data-validation-rules-json");if(typeof u=="undefined"||u==false){return true}u=f.parseJSON(u);var q=0;m.find(".input_block.error").removeClass("error");for(var p=0;p<u.length;p++){var t=u[p];var r=m.find("#"+t.field_id);if(r.length<1){continue}for(var s in t.rules){var n=t.rules[s];var o=j(r,s,n);if(o.error){r.parents(".input_block").addClass("error");r.parents(".input_block").find("span.error_msg").html(o.msg);q++}}}if(q>0){m.find(".main_error_msg").hide()}if(q>0){return false}return true}function j(p,r,u){var m={error:false,msg:""};if(p.length<1){return m}switch(r){case"required":if(p.val().length<1||p.val()==""||p.val()==" "){m.error=true;m.msg="Field is required."}break;case"email":var q=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(p.val());if(!q){m.error=true;m.msg="The email address you have entered is not valid. Please try again."}break;case"between":if(p.val().length<u.min||p.val().length>u.max){m.error=true;var s="";if(p.attr("type")!="undefined"&&p.attr("type")=="password"){s+="Passwords must be between "+u.min+" and "+u.max+" characters."}else{s+="Field must contain between "+u.min+" and "+u.max+" characters. Field currently contains "+p.val().length+" characters."}m.msg=s}break;case"notEqualTo":var t=p.val(),n="",o="";if(typeof u.attr!="undefined"){o=p.attr(u.attr);n=o}if(typeof u.caseSensitive!="undefined"){if(!u.caseSensitive){t=t.toLowerCase();n=n.toLowerCase()}}if(t==n){m.error=true;if(typeof u.errorMsg!="undefined"){m.msg=u.errorMsg}else{m.msg='Field may not contain "'+o+'"'}}break;case"noSpaces":if(p.val().match(/.*\s.*/)){m.error=true;m.msg="Please use one word with no spaces."}break}return m}return{init:g}}(a));return b}(forbes||{},jQuery));